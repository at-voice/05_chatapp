<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>index_ãƒãƒ£ãƒƒãƒˆã‚’ä½œã‚‹</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body>

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->

    <!-- æŠ•ç¨¿è¡¨ç¤ºå ´æ‰€ -->
    <ul id="output"></ul>


    <!-- æ–°è¦æŠ•ç¨¿ -->
    <form>
        <fieldset>
            <!-- ã“ã‚ŒãŒã‚ã‚‹ã¨æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ æ¬„å›²ã¾ã‚Œã‚‹ -->
            <legend>æŠ•ç¨¿ç”»é¢</legend>
            <div>
                name: <input type="text" id="name" placeholder="å°å¼éƒ¨å†…ä¾">
            </div>

            <div>
                phrase: <input type="text" id="phrase" placeholder="å¤§æ±Ÿå±±ã„ãé‡ã®é“ã®é ã‘ã‚Œã°">
            </div>

            <div>
                comment: <input type="text" id="comment" placeholder="æ¯ãŒå‰å¤§ã™ãã‚‹ãŸã‚ã„ã¤ã‚‚ä»£ä½œã‚’ç–‘ã‚ã‚Œã¦æ®ºæ„">
            </div>

            <div>
                <button type="button" id="send">send</button>
            </div>

        </fieldset>
    </form>



    <!-- ã‚ã¨ã§æ¶ˆã™ã‚„ã‚‹ã“ã¨ãƒªã‚¹ãƒˆ -->
    <div>
        <h6>ã‚„ã‚‹ã“ã¨ãƒªã‚¹ãƒˆï¼ˆã‚ã¨ã§æ¶ˆã™ï¼‰</h6>
        <ul>
            <li>firebaseé–¢æ•°ï¼Ÿã¿ãŸã„ãªã®ãŒèª­ã¿è¾¼ã‚ã¦ãªã„ã½ã„</li>
            <li>ãƒ•ã‚©ãƒ¼ãƒ ã®æ¨ªå¹…è¨­å®š</li>
        </ul>
    </div>



    <!-- ã“ã“ã‹ã‚‰JS -->

    <!-- Firebaseã‹ã‚‰ã®ã‚³ãƒ”ãƒš -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries


        // ğŸ”½ è¿½åŠ  / `9.13.0`ã®éƒ¨åˆ†ã‚’â†‘ã®Firestoreã‹ã‚‰è²¼ã‚Šä»˜ã‘ãŸã‚³ãƒ¼ãƒ‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åˆã‚ã›ã‚‹
        import {
            getFirestore,
            collection,
            addDoc,
            serverTimestamp,
            query,
            orderBy,
            onSnapshot, //firebaseãŒæŒã£ã¦ã‚‹é–¢æ•°ã‚’å¼•ã£å¼µã£ã¦ãã‚‹
        } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-firestore.js";


        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBfUIT5OnuwDz3qRdu8w_FY0JeYR7kj_o8",
            authDomain: "chat-homework-bec24.firebaseapp.com",
            projectId: "chat-homework-bec24",
            storageBucket: "chat-homework-bec24.appspot.com",
            messagingSenderId: "301135684176",
            appId: "1:301135684176:web:14f9cf14c79ec967546755"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        // ğŸ”½ è¿½åŠ 
        const db = getFirestore(app);//FbãŒèª­ã¿è¾¼ã¿ã‚„ã™ã„ã‚ˆã†ã«å¤‰ãˆãŸã‚ˆ
        const timestamp = serverTimestamp();
        console.log(timestamp);
    </script>

    <!--  æ—¥æ™‚ã‚’ã„ã„æ„Ÿã˜ã®å½¢å¼ã«ã™ã‚‹é–¢æ•° -->
    <script>
        function convertTimestampToDatetime(timestamp) {
            const _d = timestamp ? new Date(timestamp * 1000) : new Date();
            const Y = _d.getFullYear();
            const m = (_d.getMonth() + 1).toString().padStart(2, '0');
            const d = _d.getDate().toString().padStart(2, '0');
            const H = _d.getHours().toString().padStart(2, '0');
            const i = _d.getMinutes().toString().padStart(2, '0');
            const s = _d.getSeconds().toString().padStart(2, '0');
            return `${Y}/${m}/${d} ${H}:${i}:${s}`;
        }
    </script>


    <!-- æº–å‚™ã“ã“ã¾ã§ -->


    <!-- é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã®å‹•ä½œ -->
    <script>
        $("#send").on("click", function () {
            const postData = {
                name: $("#name").val(), //key:nameã€value:#nameã«å…¥ã£ã¦ã„ã‚‹ã‚‚ã®ã¨ã—ã¾ã™
                phrase: $("#phrase").val(),
                comment: $("#comment").val(),
                time: serverTimestamp(),
            };
            console.log(postData);
            addDoc(collection(db, "chat"), postData);//FBã«ç™»éŒ²ã—ã¾ã™ â€»addDoc(ãƒ©ãƒ³ãƒ€ãƒ ãªIDãŒä»˜ä¸ã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½œæˆ)
            $("#text").val("");//#textã‚’ç©ºã«ã™ã‚‹
            $("#comment").val("");//#commentã‚’ç©ºã«ã™ã‚‹

        });


    </script>







</body>

</html>